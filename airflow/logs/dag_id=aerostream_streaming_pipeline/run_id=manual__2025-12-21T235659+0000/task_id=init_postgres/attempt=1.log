{"timestamp":"2025-12-21T23:57:04.413233Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-12-21T23:57:04.414786Z","level":"info","event":"Filling up the DagBag from /app/airflow/dags/aerostream_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-12-21T23:57:04.592446Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.593140Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.594359Z","level":"info","event":"Current task name:init_postgres","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.594785Z","level":"info","event":"Dag name:aerostream_streaming_pipeline","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.685673Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1008,"error_detail":[{"exc_type":"ProgrammingError","exc_value":"(psycopg2.errors.DuplicateTable) relation \"tweet_predictions\" already exists\n\n[SQL: \nCREATE TABLE tweet_predictions (\n\tid SERIAL NOT NULL, \n\tairline VARCHAR NOT NULL, \n\ttext TEXT NOT NULL, \n\tcreated_at TIMESTAMP WITHOUT TIME ZONE, \n\toriginal_confidence FLOAT, \n\tnegative_reason VARCHAR, \n\tpredicted_sentiment VARCHAR NOT NULL, \n\tprobabilities JSON, \n\tinserted_at TIMESTAMP WITHOUT TIME ZONE DEFAULT now(), \n\tPRIMARY KEY (id)\n)\n\n]\n(Background on this error at: https://sqlalche.me/e/20/f405)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/usr/local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":934,"name":"run"},{"filename":"/usr/local/lib/python3.11/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1325,"name":"_execute_task"},{"filename":"/usr/local/lib/python3.11/site-packages/airflow/sdk/bases/operator.py","lineno":417,"name":"wrapper"},{"filename":"/usr/local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":214,"name":"execute"},{"filename":"/usr/local/lib/python3.11/site-packages/airflow/providers/standard/operators/python.py","lineno":237,"name":"execute_callable"},{"filename":"/usr/local/lib/python3.11/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/app/airflow/dags/aerostream_dag.py","lineno":10,"name":"init_db_task_fn"},{"filename":"/app/tasks/postgress_db.py","lineno":52,"name":"init_db"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/schema.py","lineno":5928,"name":"create_all"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":3260,"name":"_run_ddl_visitor"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":2467,"name":"_run_ddl_visitor"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py","lineno":661,"name":"traverse_single"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py","lineno":984,"name":"visit_metadata"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/visitors.py","lineno":661,"name":"traverse_single"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py","lineno":1022,"name":"visit_table"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py","lineno":321,"name":"_invoke_with"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1419,"name":"execute"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/sql/ddl.py","lineno":187,"name":"_execute_on_connection"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1530,"name":"_execute_ddl"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1846,"name":"_execute_context"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1986,"name":"_exec_single_context"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":2363,"name":"_handle_dbapi_exception"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1967,"name":"_exec_single_context"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py","lineno":952,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"DuplicateTable","exc_value":"relation \"tweet_predictions\" already exists\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/base.py","lineno":1967,"name":"_exec_single_context"},{"filename":"/usr/local/lib/python3.11/site-packages/sqlalchemy/engine/default.py","lineno":952,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-12-21T23:57:04.688924Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.689478Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.690065Z","level":"info","event":"Task:<Task(PythonOperator): init_postgres>","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.690615Z","level":"info","event":"Failure caused by (psycopg2.errors.DuplicateTable) relation \"tweet_predictions\" already exists","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.691187Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.691762Z","level":"info","event":"[SQL:","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.692173Z","level":"info","event":"CREATE TABLE tweet_predictions (","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.692652Z","level":"info","event":"\tid SERIAL NOT NULL,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.693248Z","level":"info","event":"\tairline VARCHAR NOT NULL,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.693717Z","level":"info","event":"\ttext TEXT NOT NULL,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.694325Z","level":"info","event":"\tcreated_at TIMESTAMP WITHOUT TIME ZONE,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.695019Z","level":"info","event":"\toriginal_confidence FLOAT,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.695598Z","level":"info","event":"\tnegative_reason VARCHAR,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.696121Z","level":"info","event":"\tpredicted_sentiment VARCHAR NOT NULL,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.696721Z","level":"info","event":"\tprobabilities JSON,","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.697214Z","level":"info","event":"\tinserted_at TIMESTAMP WITHOUT TIME ZONE DEFAULT now(),","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.697780Z","level":"info","event":"\tPRIMARY KEY (id)","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.698379Z","level":"info","event":")","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.698947Z","level":"info","event":"","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.699772Z","level":"info","event":"]","logger":"task.stdout"}
{"timestamp":"2025-12-21T23:57:04.700337Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/20/f405)","logger":"task.stdout"}
